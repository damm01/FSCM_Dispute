jQuery.sap.require("sap.m.TablePersoController");                                                                                                                                                                                                              
jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");                                                                                                                                                                                     
jQuery.sap.require("sap.ui.core.format.NumberFormat");                                                                                                                                                                                                         
jQuery.sap.require("sap.ui.model.type.FileSize");                                                                                                                                                                                                              
jQuery.sap.require("sap.m.MessageBox");                                                                                                                                                                                                                        
jQuery.sap.require("sap.ui.model.type.Date");                                                                                                                                                                                                                  
jQuery.sap.require("sap.ui.model.type.DateTime");                                                                                                                                                                                                              
jQuery.sap.require("sap.ui.model.SimpleType");                                                                                                                                                                                                                 
jQuery.sap.require("sap.m.MessageBox");                                                                                                                                                                                                                        
jQuery.sap.require("sap.ui.comp.odata.MetadataAnalyser");                                                                                                                                                                                                      
jQuery.sap.require("fin.fscm.dm.dispute.manage.util.Util");                                                                                                                                                                                                    
jQuery.sap.require("fin.fscm.dm.dispute.manage.util.BatchManagement");                                                                                                                                                                                         
jQuery.sap.require("fin.fscm.dm.dispute.manage.view.CreateCorrespondenceDialog");                                                                                                                                                                              
sap.ui.controller("fin.fscm.dm.dispute.manage.FSCM_DISPUTESExtension.view.DisputeDetailsCustom", {                                                                                                                                                             
                                                                                                                                                                                                                                                               
	renderCustomerFields: function (c, d, w) {                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
		//console.log("!!!!!! Test !!!!!!");                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
		var g = [];                                                                                                                                                                                                                                                  
		c = jQuery.extend(true, {}, c);                                                                                                                                                                                                                              
		var s = parseInt(this.oDispute.SystemStatus, 10);                                                                                                                                                                                                            
		if (s >= 7) {                                                                                                                                                                                                                                                
			this.oJsonModel.setProperty("/EditMode", false);                                                                                                                                                                                                            
			jQuery.each(c, function (a, C) {                                                                                                                                                                                                                            
				C.DisplayOnly = true;                                                                                                                                                                                                                                      
			});                                                                                                                                                                                                                                                         
		}                                                                                                                                                                                                                                                            
		jQuery.each(c, jQuery.proxy(function (a, v) {                                                                                                                                                                                                                
			if (!g[v.GroupID]) {                                                                                                                                                                                                                                        
				var S = new sap.ui.layout.form.SimpleForm({                                                                                                                                                                                                                
					layout: sap.ui.layout.form.SimpleFormLayout.ResponsiveGridLayout,                                                                                                                                                                                         
					maxContainerCols: 3,                                                                                                                                                                                                                                      
					emptySpanL: 0,                                                                                                                                                                                                                                            
					columnsL: 3,                                                                                                                                                                                                                                              
					columnsM: 2,                                                                                                                                                                                                                                              
					width: "100%",                                                                                                                                                                                                                                            
					title: v.GroupTitle,                                                                                                                                                                                                                                      
					editable: true                                                                                                                                                                                                                                            
				});                                                                                                                                                                                                                                                        
				S.addContent(new sap.ui.core.Title());                                                                                                                                                                                                                     
				w.addContent(S);                                                                                                                                                                                                                                           
				g[v.GroupID] = {                                                                                                                                                                                                                                           
					elem: S                                                                                                                                                                                                                                                   
				};                                                                                                                                                                                                                                                         
			}                                                                                                                                                                                                                                                           
			var S = g[v.GroupID].elem;                                                                                                                                                                                                                                  
			if (a > 0) {                                                                                                                                                                                                                                                
				var C = parseInt(v.RowNo, 10);                                                                                                                                                                                                                             
				var b = parseInt(c[a - 1].RowNo, 10);                                                                                                                                                                                                                      
				var e = parseInt(v.ColumnNo, 10);                                                                                                                                                                                                                          
				var f = parseInt(c[a - 1].ColumnNo, 10);                                                                                                                                                                                                                   
				if (C - b > 1 && e === f) {                                                                                                                                                                                                                                
					var n = C - b - 1;                                                                                                                                                                                                                                        
					for (var i = 0; i < n; i++) {                                                                                                                                                                                                                             
						S.addContent(new sap.m.Label());                                                                                                                                                                                                                         
						S.addContent(new sap.m.Text());                                                                                                                                                                                                                          
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
				if (f === 1 && e === 2 || f == 2 && e == 3) {                                                                                                                                                                                                              
					S.addContent(new sap.ui.core.Title());                                                                                                                                                                                                                    
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			if (v.Hidden) {                                                                                                                                                                                                                                             
				S.addContent(new sap.m.Label());                                                                                                                                                                                                                           
				S.addContent(new sap.m.Text());                                                                                                                                                                                                                            
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			if (!d[v.Attribute]) {                                                                                                                                                                                                                                      
				jQuery.sap.log.warning("fin.fscm.dm.dispute.manage.view.DisputeDetails: Metadata of dispute entity is missing for property", v.Attribute);                                                                                                                 
				return;                                                                                                                                                                                                                                                    
			}                                                                                                                                                                                                                                                           
			var l = new sap.m.Label({                                                                                                                                                                                                                                   
				text: v.Attribute,                                                                                                                                                                                                                                         
				tooltip: v.Attribute,                                                                                                                                                                                                                                      
				width: "100%", //Anmol                                                                                                                                                                                                                                     
				design: sap.m.LabelDesign.Bold //CHANGE BY CHRISTIAN FOR BOLD LABELS                                                                                                                                                                                       
			});                                                                                                                                                                                                                                                         
			var I = null;                                                                                                                                                                                                                                               
			var o = null;                                                                                                                                                                                                                                               
			var B = null;                                                                                                                                                                                                                                               
			if (v.DisplayOnly) {                                                                                                                                                                                                                                        
				if (v.IsCheckbox) {                                                                                                                                                                                                                                        
					I = new sap.m.CheckBox();                                                                                                                                                                                                                                 
					I.setEnabled(false);                                                                                                                                                                                                                                      
					B = {                                                                                                                                                                                                                                                     
						path: v.Attribute                                                                                                                                                                                                                                        
					};                                                                                                                                                                                                                                                        
					I.bindProperty("selected", B);                                                                                                                                                                                                                            
				} else {                                                                                                                                                                                                                                                   
					I = new sap.m.Text();                                                                                                                                                                                                                                     
					I.setTextAlign(sap.ui.core.TextAlign.End);                                                                                                                                                                                                                
					I.setWidth("100%"); //Anmol                                                                                                                                                                                                                               
					switch (d[v.Attribute].type) {                                                                                                                                                                                                                            
					case "Edm.DateTime":                                                                                                                                                                                                                                      
						B = {                                                                                                                                                                                                                                                    
							path: v.Attribute,                                                                                                                                                                                                                                      
							type: "sap.ui.model.type.DateTime",                                                                                                                                                                                                                     
							formatOptions: {                                                                                                                                                                                                                                        
								style: "medium"                                                                                                                                                                                                                                        
							}                                                                                                                                                                                                                                                       
						};                                                                                                                                                                                                                                                       
						break;                                                                                                                                                                                                                                                   
					case "Edm.Date":                                                                                                                                                                                                                                          
						B = {                                                                                                                                                                                                                                                    
							path: v.Attribute,                                                                                                                                                                                                                                      
							type: "sap.ui.model.type.Date",                                                                                                                                                                                                                         
							formatOptions: {                                                                                                                                                                                                                                        
								style: "medium"                                                                                                                                                                                                                                        
							}                                                                                                                                                                                                                                                       
						};                                                                                                                                                                                                                                                       
						break;                                                                                                                                                                                                                                                   
					case "Edm.Decimal":                                                                                                                                                                                                                                       
						if (d[v.Attribute].unitField) {                                                                                                                                                                                                                          
							B = {                                                                                                                                                                                                                                                   
								parts: [                                                                                                                                                                                                                                               
									v.Attribute,                                                                                                                                                                                                                                          
									d[v.Attribute].unitField                                                                                                                                                                                                                              
								],                                                                                                                                                                                                                                                     
								formatter: this.formatCurrencyAmount                                                                                                                                                                                                                   
							};                                                                                                                                                                                                                                                      
						} else {                                                                                                                                                                                                                                                 
							B = {                                                                                                                                                                                                                                                   
								path: v.Attribute                                                                                                                                                                                                                                      
							};                                                                                                                                                                                                                                                      
						}                                                                                                                                                                                                                                                        
						break;                                                                                                                                                                                                                                                   
					default:                                                                                                                                                                                                                                                  
						if (d[v.Attribute].descr) {                                                                                                                                                                                                                              
							B = {                                                                                                                                                                                                                                                   
								path: d[v.Attribute].descr                                                                                                                                                                                                                             
							};                                                                                                                                                                                                                                                      
						} else {                                                                                                                                                                                                                                                 
							B = {                                                                                                                                                                                                                                                   
								path: v.Attribute                                                                                                                                                                                                                                      
							};                                                                                                                                                                                                                                                      
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					I.bindProperty("text", B);                                                                                                                                                                                                                                
				}                                                                                                                                                                                                                                                          
			} else {                                                                                                                                                                                                                                                    
				if (v.IsCheckbox) {                                                                                                                                                                                                                                        
					I = new sap.m.CheckBox();                                                                                                                                                                                                                                 
					B = {                                                                                                                                                                                                                                                     
						path: v.Attribute,                                                                                                                                                                                                                                       
						mode: sap.ui.model.BindingMode.TwoWay                                                                                                                                                                                                                    
					};                                                                                                                                                                                                                                                        
					if (d[v.Attribute].type !== "Edm.Boolean") {                                                                                                                                                                                                              
						B.type = new fin.fscm.dm.dispute.manage.Util.CheckBoxForString();                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					I.bindProperty("selected", B);                                                                                                                                                                                                                            
				} else if (v.IsDropdown) {                                                                                                                                                                                                                                 
					var h = null;                                                                                                                                                                                                                                             
					if (v.Attribute === "Status") {                                                                                                                                                                                                                           
						h = new sap.ui.core.Item({                                                                                                                                                                                                                               
							text: "{StatusDescription}",                                                                                                                                                                                                                            
							key: "{Status}",                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
						});                                                                                                                                                                                                                                                      
						I = new sap.m.ComboBox({                                                                                                                                                                                                                                 
							width: "100%",                                                                                                                                                                                                                                          
							items: {                                                                                                                                                                                                                                                
								path: "/GetValidStatusList",                                                                                                                                                                                                                           
								template: h,                                                                                                                                                                                                                                           
								parameters: {                                                                                                                                                                                                                                          
									custom: {                                                                                                                                                                                                                                             
										CaseType: "'" + this.oDispute.CaseType + "'",                                                                                                                                                                                                        
										CurrentStatus: "'" + this.oDispute.Status + "'"                                                                                                                                                                                                      
									}                                                                                                                                                                                                                                                     
								},                                                                                                                                                                                                                                                     
								events: {                                                                                                                                                                                                                                              
									dataReceived: function () {                                                                                                                                                                                                                           
										I.bindProperty("selectedKey", {                                                                                                                                                                                                                      
											path: v.Attribute,                                                                                                                                                                                                                                  
											mode: sap.ui.model.BindingMode.TwoWay,                                                                                                                                                                                                              
											type: new fin.fscm.dm.dispute.manage.Util.EmptyToNullType("0")                                                                                                                                                                                      
										});                                                                                                                                                                                                                                                  
									}                                                                                                                                                                                                                                                     
								}                                                                                                                                                                                                                                                      
							},                                                                                                                                                                                                                                                      
							change: function (E) {                                                                                                                                                                                                                                  
								this._handleComboBoxSelectionChange(E);                                                                                                                                                                                                                
							}.bind(this)                                                                                                                                                                                                                                            
						});                                                                                                                                                                                                                                                      
						this.aStatusListControls.push(I);                                                                                                                                                                                                                        
					} else {                                                                                                                                                                                                                                                  
						if (d[v.Attribute].annotation) {                                                                                                                                                                                                                         
							var A = d[v.Attribute].annotation;                                                                                                                                                                                                                      
							h = new sap.ui.core.Item({                                                                                                                                                                                                                              
								text: "{" + A.descr + "}",                                                                                                                                                                                                                             
								key: "{" + A.key + "}"                                                                                                                                                                                                                                 
							});                                                                                                                                                                                                                                                     
							var F = [];                                                                                                                                                                                                                                             
							if (A.inParams) {                                                                                                                                                                                                                                       
								jQuery.each(A.inParams, jQuery.proxy(function (a, p) {                                                                                                                                                                                                 
									F.push(new sap.ui.model.Filter(p.valueList, sap.ui.model.FilterOperator.StartsWith, this.oDispute[p.dataProperty]));                                                                                                                                  
								}, this));                                                                                                                                                                                                                                             
							}                                                                                                                                                                                                                                                       
							var D = "";                                                                                                                                                                                                                                             
							if (d[v.Attribute].type === "Edm.Decimal") {                                                                                                                                                                                                            
								D = "0";                                                                                                                                                                                                                                               
							}                                                                                                                                                                                                                                                       
							I = new sap.m.ComboBox({                                                                                                                                                                                                                                
								width: "100%",                                                                                                                                                                                                                                         
								items: {                                                                                                                                                                                                                                               
									path: "/" + A.collectionPath,                                                                                                                                                                                                                         
									template: h,                                                                                                                                                                                                                                          
									filters: F,                                                                                                                                                                                                                                           
									events: {                                                                                                                                                                                                                                             
										dataReceived: function () {                                                                                                                                                                                                                          
											I.bindProperty("selectedKey", {                                                                                                                                                                                                                     
												path: v.Attribute,                                                                                                                                                                                                                                 
												mode: sap.ui.model.BindingMode.TwoWay,                                                                                                                                                                                                             
												type: new fin.fscm.dm.dispute.manage.Util.EmptyToNullType(D)                                                                                                                                                                                       
											});                                                                                                                                                                                                                                                 
										}                                                                                                                                                                                                                                                    
									}                                                                                                                                                                                                                                                     
								},                                                                                                                                                                                                                                                     
								change: function (E) {                                                                                                                                                                                                                                 
									this._handleComboBoxSelectionChange(E);                                                                                                                                                                                                               
								}.bind(this)                                                                                                                                                                                                                                           
							});                                                                                                                                                                                                                                                     
						} else {                                                                                                                                                                                                                                                 
							if (d[v.Attribute].descr) {                                                                                                                                                                                                                             
								h = new sap.ui.core.Item({                                                                                                                                                                                                                             
									text: "{" + d[v.Attribute].descr + "}",                                                                                                                                                                                                               
									key: "{" + v.Attribute + "}"                                                                                                                                                                                                                          
								});                                                                                                                                                                                                                                                    
							} else {                                                                                                                                                                                                                                                
								h = new sap.ui.core.Item({                                                                                                                                                                                                                             
									text: "{" + v.Attribute + "}",                                                                                                                                                                                                                        
									key: "{" + v.Attribute + "}"                                                                                                                                                                                                                          
								});                                                                                                                                                                                                                                                    
							}                                                                                                                                                                                                                                                       
							I = new sap.m.ComboBox({                                                                                                                                                                                                                                
								items: [h],                                                                                                                                                                                                                                            
								width: "100%"                                                                                                                                                                                                                                          
							});                                                                                                                                                                                                                                                     
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
				} else {                                                                                                                                                                                                                                                   
					switch (d[v.Attribute].type) {                                                                                                                                                                                                                            
					case "Edm.DateTime":                                                                                                                                                                                                                                      
						I = new sap.m.DatePicker(v.Attribute);                                                                                                                                                                                                                   
						I.setWidth("100%");                                                                                                                                                                                                                                      
						B = {                                                                                                                                                                                                                                                    
							path: v.Attribute,                                                                                                                                                                                                                                      
							mode: sap.ui.model.BindingMode.TwoWay,                                                                                                                                                                                                                  
							type: "fin.fscm.dm.dispute.manage.Util.UTCDate"                                                                                                                                                                                                         
						};                                                                                                                                                                                                                                                       
						I.bindProperty("dateValue", B);                                                                                                                                                                                                                          
						break;                                                                                                                                                                                                                                                   
					case "Edm.Date":                                                                                                                                                                                                                                          
						I = new sap.m.DatePicker();                                                                                                                                                                                                                              
						I.setWidth("100%");                                                                                                                                                                                                                                      
						B = {                                                                                                                                                                                                                                                    
							path: v.Attribute,                                                                                                                                                                                                                                      
							mode: sap.ui.model.BindingMode.TwoWay                                                                                                                                                                                                                   
						};                                                                                                                                                                                                                                                       
						I.bindProperty("value", B);                                                                                                                                                                                                                              
						break;                                                                                                                                                                                                                                                   
					case "Edm.Decimal":                                                                                                                                                                                                                                       
						if (d[v.Attribute].unitField) {                                                                                                                                                                                                                          
							I = new sap.m.Input({                                                                                                                                                                                                                                   
								width: "100%",                                                                                                                                                                                                                                         
								showValueStateMessage: true,                                                                                                                                                                                                                           
								valueLiveUpdate: false                                                                                                                                                                                                                                 
							});                                                                                                                                                                                                                                                     
							if (d[v.Attribute].maxLength) {                                                                                                                                                                                                                         
								I.setMaxLength(d[v.Attribute].maxLength);                                                                                                                                                                                                              
							}                                                                                                                                                                                                                                                       
							var V = {                                                                                                                                                                                                                                               
								IsMandatory: !d[v.Attribute].nullable                                                                                                                                                                                                                  
							};                                                                                                                                                                                                                                                      
							B = {                                                                                                                                                                                                                                                   
								path: v.Attribute,                                                                                                                                                                                                                                     
								mode: sap.ui.model.BindingMode.TwoWay,                                                                                                                                                                                                                 
								type: new fin.fscm.dm.dispute.manage.Util.CurrencyInputType(this.oBundle, V)                                                                                                                                                                           
							};                                                                                                                                                                                                                                                      
							I.bindProperty("value", B);                                                                                                                                                                                                                             
							break;                                                                                                                                                                                                                                                  
						} else {                                                                                                                                                                                                                                                 
							I = new sap.m.Input({                                                                                                                                                                                                                                   
								width: "100%", //anmol                                                                                                                                                                                                                                 
								showValueStateMessage: true,                                                                                                                                                                                                                           
								valueLiveUpdate: true                                                                                                                                                                                                                                  
							});                                                                                                                                                                                                                                                     
							if (d[v.Attribute].maxLength) {                                                                                                                                                                                                                         
								I.setMaxLength(d[v.Attribute].maxLength);                                                                                                                                                                                                              
							}                                                                                                                                                                                                                                                       
							var V = {                                                                                                                                                                                                                                               
								IsMandatory: !d[v.Attribute].nullable                                                                                                                                                                                                                  
							};                                                                                                                                                                                                                                                      
							B = {                                                                                                                                                                                                                                                   
								path: v.Attribute,                                                                                                                                                                                                                                     
								mode: sap.ui.model.BindingMode.TwoWay,                                                                                                                                                                                                                 
								type: new fin.fscm.dm.dispute.manage.Util.InputValidationType(this.oBundle, V)                                                                                                                                                                         
							};                                                                                                                                                                                                                                                      
							I.bindProperty("value", B);                                                                                                                                                                                                                             
							break;                                                                                                                                                                                                                                                  
						}                                                                                                                                                                                                                                                        
					default:                                                                                                                                                                                                                                                  
						I = new sap.m.Input({                                                                                                                                                                                                                                    
							valueLiveUpdate: true,                                                                                                                                                                                                                                  
							width: "100%"                                                                                                                                                                                                                                           
						});                                                                                                                                                                                                                                                      
						/*if (d[v.Attribute].maxLength) {                                                                                                                                                                                                                        
						    I.setMaxLength(d[v.Attribute].maxLength);                                                                                                                                                                                                            
						}*/                                                                                                                                                                                                                                                      
						if (d[v.Attribute].descr) {                                                                                                                                                                                                                              
							B = {                                                                                                                                                                                                                                                   
								path: d[v.Attribute].descr                                                                                                                                                                                                                             
							};                                                                                                                                                                                                                                                      
							I.bindProperty("description", B);                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
						B = {                                                                                                                                                                                                                                                    
							path: v.Attribute,                                                                                                                                                                                                                                      
							mode: sap.ui.model.BindingMode.TwoWay                                                                                                                                                                                                                   
						};                                                                                                                                                                                                                                                       
						I.bindProperty("value", B);                                                                                                                                                                                                                              
						I.setModel(this.oDataModel);                                                                                                                                                                                                                             
						if (d[v.Attribute].annotation) {                                                                                                                                                                                                                         
							this.oUtil.provideSearchHelp({                                                                                                                                                                                                                          
								control: I,                                                                                                                                                                                                                                            
								entity: "Dispute",                                                                                                                                                                                                                                     
								property: v.Attribute                                                                                                                                                                                                                                  
							});                                                                                                                                                                                                                                                     
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
				var j = jQuery.proxy(function (E) {                                                                                                                                                                                                                        
					if (E && E.getSource() && E.getSource().getMetadata() && E.getSource().getMetadata().getName() === "sap.m.DatePicker") {                                                                                                                                  
						if (!E.getParameters().valid) {                                                                                                                                                                                                                          
							var k = E.getSource();                                                                                                                                                                                                                                  
							k.setValueState(sap.ui.core.ValueState.Error);                                                                                                                                                                                                          
							this.oFormErrors[k.getId()] = k;                                                                                                                                                                                                                        
						} else {                                                                                                                                                                                                                                                 
							if (this.oFormErrors[E.getSource().getId()]) {                                                                                                                                                                                                          
								var k = E.getSource();                                                                                                                                                                                                                                 
								k.setValueState(sap.ui.core.ValueState.None);                                                                                                                                                                                                          
								delete this.oFormErrors[k.getId()];                                                                                                                                                                                                                    
							}                                                                                                                                                                                                                                                       
						}                                                                                                                                                                                                                                                        
					}                                                                                                                                                                                                                                                         
					this.updateSaveButtonState();                                                                                                                                                                                                                             
				}, this);                                                                                                                                                                                                                                                  
				if (I.attachLiveChange) {                                                                                                                                                                                                                                  
					I.attachLiveChange(j);                                                                                                                                                                                                                                    
				}                                                                                                                                                                                                                                                          
				if (I.attachSelectionChange) {                                                                                                                                                                                                                             
					I.attachSelectionChange(j);                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
				if (I.attachSelect) {                                                                                                                                                                                                                                      
					I.attachSelect(j);                                                                                                                                                                                                                                        
				}                                                                                                                                                                                                                                                          
				if (I.attachChange) {                                                                                                                                                                                                                                      
					I.attachChange(j);                                                                                                                                                                                                                                        
				} else {                                                                                                                                                                                                                                                   
					jQuery.sap.log.warning("fin.fscm.dm.dispute.manage.view.DisputeDetails: Control not supported to enable update button", I);                                                                                                                               
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			if (d[v.Attribute]) {                                                                                                                                                                                                                                       
				if (d[v.Attribute].text) {                                                                                                                                                                                                                                 
					l.setText(d[v.Attribute].text);                                                                                                                                                                                                                           
				} else {                                                                                                                                                                                                                                                   
					l.setText(v.Attribute);                                                                                                                                                                                                                                   
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
			S.addContent(l);                                                                                                                                                                                                                                            
			if (o) {                                                                                                                                                                                                                                                    
				S.addContent(o);                                                                                                                                                                                                                                           
				o = null;                                                                                                                                                                                                                                                  
			} else {                                                                                                                                                                                                                                                    
				S.addContent(I);                                                                                                                                                                                                                                           
			}                                                                                                                                                                                                                                                           
		}, this));                                                                                                                                                                                                                                                   
		this.oLoadBusyDialog.close();                                                                                                                                                                                                                                
	},                                                                                                                                                                                                                                                            
	_handleComboBoxSelectionChange: function (e) {                                                                                                                                                                                                                
		var s = e.getSource();                                                                                                                                                                                                                                       
		var c = s.getId();                                                                                                                                                                                                                                           
		if (e.getParameters().itemPressed) {                                                                                                                                                                                                                         
			s.setValueState(sap.ui.core.ValueState.None);                                                                                                                                                                                                               
			delete this.oFormErrors[c];                                                                                                                                                                                                                                 
		} else {                                                                                                                                                                                                                                                     
			if (e.getParameters().value) {                                                                                                                                                                                                                              
				if (s.getSelectedKey()) {                                                                                                                                                                                                                                  
					if (s.getSelectedItem()) {                                                                                                                                                                                                                                
						s.setValueState(sap.ui.core.ValueState.None);                                                                                                                                                                                                            
						delete this.oFormErrors[c];                                                                                                                                                                                                                              
					} else {                                                                                                                                                                                                                                                  
						s.setValueState(sap.ui.core.ValueState.Error);                                                                                                                                                                                                           
						this.oFormErrors[c] = true;                                                                                                                                                                                                                              
					}                                                                                                                                                                                                                                                         
				} else {                                                                                                                                                                                                                                                   
					s.setValueState(sap.ui.core.ValueState.Error);                                                                                                                                                                                                            
					this.oFormErrors[c] = true;                                                                                                                                                                                                                               
				}                                                                                                                                                                                                                                                          
			} else {                                                                                                                                                                                                                                                    
				s.setValueState(sap.ui.core.ValueState.None);                                                                                                                                                                                                              
				delete this.oFormErrors[c];                                                                                                                                                                                                                                
			}                                                                                                                                                                                                                                                           
		}                                                                                                                                                                                                                                                            
		this.updateSaveButtonState();                                                                                                                                                                                                                                
	},                                                                                                                                                                                                                                                            
	loadCustomerFields: function (c) {                                                                                                                                                                                                                            
		this.aDisputeMetadata = this.prepareMetadataForCustomerFields();                                                                                                                                                                                             
		var w = this.byId("customerFields");                                                                                                                                                                                                                         
		w.destroyContent();                                                                                                                                                                                                                                          
		this.aStatusListControls = [];                                                                                                                                                                                                                               
		var e = jQuery.proxy(function (E) {                                                                                                                                                                                                                          
			var m = fin.fscm.dm.dispute.manage.util.BatchManagement.prototype.parseErrorMessage(E);                                                                                                                                                                     
			this.oUtil.showErrorMessageDialog(m);                                                                                                                                                                                                                       
		}, this);                                                                                                                                                                                                                                                    
		var s = jQuery.proxy(function (d) {                                                                                                                                                                                                                          
			if (d && d.__batchResponses && d.__batchResponses.length > 0 && d.__batchResponses[0].data && d.__batchResponses[0].data.results) {                                                                                                                         
				this.aAttributeSet = d.__batchResponses[0].data.results;                                                                                                                                                                                                   
				this.renderCustomerFields(this.aAttributeSet, this.aDisputeMetadata, w);                                                                                                                                                                                   
			} else {                                                                                                                                                                                                                                                    
				jQuery.sap.log.warning("fin.fscm.dm.dispute.manage.view.DisputeDetails: Could not read attribute profile");                                                                                                                                                
			}                                                                                                                                                                                                                                                           
		}, this);                                                                                                                                                                                                                                                    
		//c = "ZDM9";  //test                                                                                                                                                                                                                                        
		var p = "GetAttributeProperties?CaseType='" + c + "'";                                                                                                                                                                                                       
		var b = [];                                                                                                                                                                                                                                                  
		b.push(this.oDataModel.createBatchOperation(p, "GET"));                                                                                                                                                                                                      
		this.oDataModel.addBatchReadOperations(b);                                                                                                                                                                                                                   
		this.oDataModel.submitBatch(s, e);                                                                                                                                                                                                                           
	},                                                                                                                                                                                                                                                            
	onPhoneNoClick: function (e) {                                                                                                                                                                                                                                
		var s = e.getSource();                                                                                                                                                                                                                                       
		var n = s.getText();                                                                                                                                                                                                                                         
		sap.m.URLHelper.triggerTel(n);                                                                                                                                                                                                                               
	},                                                                                                                                                                                                                                                            
	discardAllChanges: function () {                                                                                                                                                                                                                              
		if (this.hasPendingChanges()) {                                                                                                                                                                                                                              
			if (!this.oDataLossDialog) {                                                                                                                                                                                                                                
				this.oDataLossDialog = sap.ui.xmlfragment("DataLossDialog", "fin.fscm.dm.dispute.manage.util.DataLossDialog", this);                                                                                                                                       
				this.getView().addDependent(this.oDataLossDialog);                                                                                                                                                                                                         
			}                                                                                                                                                                                                                                                           
			this.oDataLossDialog.open();                                                                                                                                                                                                                                
		} else {                                                                                                                                                                                                                                                     
			this.navBack();                                                                                                                                                                                                                                             
		}                                                                                                                                                                                                                                                            
	},                                                                                                                                                                                                                                                            
	saveDisputeDetails: function () {                                                                                                                                                                                                                             
		var d = jQuery.Deferred();                                                                                                                                                                                                                                   
		var s = jQuery.Deferred();                                                                                                                                                                                                                                   
		var r = this.oUnchangedDispute.Status !== this.oDispute.Status;                                                                                                                                                                                              
		var S = jQuery.proxy(function () {                                                                                                                                                                                                                           
			s.resolveWith(this);                                                                                                                                                                                                                                        
		}, this);                                                                                                                                                                                                                                                    
		var e = jQuery.proxy(function (E) {                                                                                                                                                                                                                          
			s.rejectWith(this, [E]);                                                                                                                                                                                                                                    
		}, this);                                                                                                                                                                                                                                                    
		s.done(function () {                                                                                                                                                                                                                                         
			this.getDisputeEntityPathFromCaseGuid().done(function (p) {                                                                                                                                                                                                 
				this.sPath = p;                                                                                                                                                                                                                                            
				if (r) {                                                                                                                                                                                                                                                   
					this.triggerRefreshStatusLists();                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
				d.resolveWith(this);                                                                                                                                                                                                                                       
			}).fail(function () {                                                                                                                                                                                                                                       
				d.rejectWith(this);                                                                                                                                                                                                                                        
			});                                                                                                                                                                                                                                                         
		});                                                                                                                                                                                                                                                          
		s.fail(function (E) {                                                                                                                                                                                                                                        
			d.rejectWith(this, [E]);                                                                                                                                                                                                                                    
		});                                                                                                                                                                                                                                                          
		if (this.oDataModel.hasPendingChanges()) {                                                                                                                                                                                                                   
			this.oDataModel.submitChanges(S, e);                                                                                                                                                                                                                        
		} else {                                                                                                                                                                                                                                                     
			d.resolveWith(this);                                                                                                                                                                                                                                        
		}                                                                                                                                                                                                                                                            
		return d.promise();                                                                                                                                                                                                                                          
	},                                                                                                                                                                                                                                                            
	triggerRefreshStatusLists: function () {                                                                                                                                                                                                                      
		jQuery.each(this.aStatusListControls, jQuery.proxy(function (i, s) {                                                                                                                                                                                         
			var b = s.getBindingInfo("items");                                                                                                                                                                                                                          
			var r = false;                                                                                                                                                                                                                                              
			if (b) {                                                                                                                                                                                                                                                    
				if (b.parameters && b.parameters.custom && b.parameters.custom.CurrentStatus) {                                                                                                                                                                            
					if (b.parameters.custom.CurrentStatus !== "'" + this.oDispute.Status + "'") {                                                                                                                                                                             
						r = true;                                                                                                                                                                                                                                                
						b.parameters.custom.CurrentStatus = "'" + this.oDispute.Status + "'";                                                                                                                                                                                    
					}                                                                                                                                                                                                                                                         
				}                                                                                                                                                                                                                                                          
				if (r) {                                                                                                                                                                                                                                                   
					s.bindItems(b);                                                                                                                                                                                                                                           
				}                                                                                                                                                                                                                                                          
			}                                                                                                                                                                                                                                                           
		}, this));                                                                                                                                                                                                                                                   
	},                                                                                                                                                                                                                                                            
	saveNote: function () {                                                                                                                                                                                                                                       
		var d = jQuery.Deferred();                                                                                                                                                                                                                                   
		var s = jQuery.Deferred();                                                                                                                                                                                                                                   
		var n = this.byId("NoteInput");                                                                                                                                                                                                                              
		var v = n.getValue();                                                                                                                                                                                                                                        
		if (this.oDataModel.hasPendingChanges()) {                                                                                                                                                                                                                   
			d.rejectWith(this);                                                                                                                                                                                                                                         
			return d;                                                                                                                                                                                                                                                   
		}                                                                                                                                                                                                                                                            
		var e = {                                                                                                                                                                                                                                                    
			NoteContent: v,                                                                                                                                                                                                                                             
			CaseGuid: this.sCaseGuid                                                                                                                                                                                                                                    
		};                                                                                                                                                                                                                                                           
		var S = jQuery.proxy(function (D, r) {                                                                                                                                                                                                                       
			s.resolveWith(this, [                                                                                                                                                                                                                                       
				D,                                                                                                                                                                                                                                                         
				r                                                                                                                                                                                                                                                          
			]);                                                                                                                                                                                                                                                         
		}, this);                                                                                                                                                                                                                                                    
		var E = jQuery.proxy(function (D) {                                                                                                                                                                                                                          
			s.rejectWith(this, [D]);                                                                                                                                                                                                                                    
		}, this);                                                                                                                                                                                                                                                    
		var p = {                                                                                                                                                                                                                                                    
			success: S,                                                                                                                                                                                                                                                 
			error: E,                                                                                                                                                                                                                                                   
			async: true                                                                                                                                                                                                                                                 
		};                                                                                                                                                                                                                                                           
		s.done(function (D, r) {                                                                                                                                                                                                                                     
			var a = r && r.data && r.data.__batchResponses && r.data.__batchResponses.length && r.data.__batchResponses[0] && r.data.__batchResponses[                                                                                                                  
					0].__changeResponses && r.data.__batchResponses[0].__changeResponses.length && r.data.__batchResponses[0].__changeResponses[0] &&                                                                                                                         
				r.data.__batchResponses[0].__changeResponses[0].statusCode && parseInt(r.data.__batchResponses[0].__changeResponses[0].statusCode) ||                                                                                                                      
				undefined;                                                                                                                                                                                                                                                 
			if (a === 201) {                                                                                                                                                                                                                                            
				n.setValue("");                                                                                                                                                                                                                                            
				this.getDisputeEntityPathFromCaseGuid().then(function (P) {                                                                                                                                                                                                
					this.sPath = P;                                                                                                                                                                                                                                           
					d.resolveWith(this, [D]);                                                                                                                                                                                                                                 
				}, function () {                                                                                                                                                                                                                                           
					d.rejectWith(this);                                                                                                                                                                                                                                       
				});                                                                                                                                                                                                                                                        
			} else {                                                                                                                                                                                                                                                    
				d.rejectWith(this, [                                                                                                                                                                                                                                       
					D,                                                                                                                                                                                                                                                        
					r                                                                                                                                                                                                                                                         
				]);                                                                                                                                                                                                                                                        
			}                                                                                                                                                                                                                                                           
		});                                                                                                                                                                                                                                                          
		s.fail(function (D) {                                                                                                                                                                                                                                        
			d.rejectWith(this, [D]);                                                                                                                                                                                                                                    
		});                                                                                                                                                                                                                                                          
		if (v !== "") {                                                                                                                                                                                                                                              
			this.oDataModel.create("/CaseNoteSet", e, p);                                                                                                                                                                                                               
		} else {                                                                                                                                                                                                                                                     
			d.resolveWith(this);                                                                                                                                                                                                                                        
		}                                                                                                                                                                                                                                                            
		return d.promise();                                                                                                                                                                                                                                          
	},                                                                                                                                                                                                                                                            
	addAttachment: function () {                                                                                                                                                                                                                                  
		var d = jQuery.Deferred();                                                                                                                                                                                                                                   
		var s = jQuery.Deferred();                                                                                                                                                                                                                                   
		var u = jQuery.proxy(this.onAttachmentUploadComplete, this, s);                                                                                                                                                                                              
		var f = this.byId("attachmentFileUploader");                                                                                                                                                                                                                 
		if (this.oDataModel.hasPendingChanges()) {                                                                                                                                                                                                                   
			d.rejectWith(this);                                                                                                                                                                                                                                         
			return d.promise();                                                                                                                                                                                                                                         
		}                                                                                                                                                                                                                                                            
		s.done(function (D) {                                                                                                                                                                                                                                        
			if (f.clear) {                                                                                                                                                                                                                                              
				f.clear();                                                                                                                                                                                                                                                 
			} else {                                                                                                                                                                                                                                                    
				f.setValue("");                                                                                                                                                                                                                                            
			}                                                                                                                                                                                                                                                           
			this.byId("BtnCleanAttachmentFileUploader").setEnabled(false);                                                                                                                                                                                              
			this.getDisputeEntityPathFromCaseGuid().then(function (p) {                                                                                                                                                                                                 
				this.sPath = p;                                                                                                                                                                                                                                            
				d.resolveWith(this, [D]);                                                                                                                                                                                                                                  
			}, function () {                                                                                                                                                                                                                                            
				d.rejectWith(this);                                                                                                                                                                                                                                        
			});                                                                                                                                                                                                                                                         
		});                                                                                                                                                                                                                                                          
		s.fail(function (D) {                                                                                                                                                                                                                                        
			d.rejectWith(this, [D]);                                                                                                                                                                                                                                    
		});                                                                                                                                                                                                                                                          
		s.always(function () {                                                                                                                                                                                                                                       
			f.detachUploadComplete(u);                                                                                                                                                                                                                                  
		});                                                                                                                                                                                                                                                          
		if (f.getValue() !== "") {                                                                                                                                                                                                                                   
			f.attachUploadComplete(u);                                                                                                                                                                                                                                  
			f.upload();                                                                                                                                                                                                                                                 
		} else {                                                                                                                                                                                                                                                     
			d.resolveWith(this);                                                                                                                                                                                                                                        
		}                                                                                                                                                                                                                                                            
		return d.promise();                                                                                                                                                                                                                                          
	}                                                                                                                                                                                                                                                             
});                                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               